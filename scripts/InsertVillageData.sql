INSERT INTO [Subject].[Village] ([Name], GPSLatitude,GPSLongitude,EthnicGroup,HasRunningWater,HasElectricity,HasSchool,DistanceToMarket)
SELECT VillageName, Lat, Long, 
    (
        SELECT EG.EthnicGroupID
        FROM [Subject].EthnicGroup EG 
        WHERE EG.Name = dta.EGName
    ) AS EGID,
    Water, Electric, School, Mkt
FROM(
    VALUES
        (N'Gerik', 5.4168, 101.1164, N'temiar', 0, 0, 0, 9),
        (N'Raub', 3.7899, 101.857, N'Semai', 0,0,0,4),
        (N'Kuala Koh', 4.8705, 102.4402, N'Batek', 0,0,0,5),
        (N'Merapoh',4.6965,102.004,N'Batek',0,1,1,1)
) dta(VillageName, Lat, Long, EGName, Water, Electric, School, Mkt)

INSERT INTO [Clinic].[VillageSite] (SiteName, VillageID)
SELECT SiteName,
(
    SELECT VillageID 
    FROM [Subject].[Village] V 
    WHERE V.Name = dta.VillageName
) AS VillageID
FROM (
    VALUES
        (N'T', N'Gerik'),
        (N'F', N'Raub'),
        (N'M', N'Kuala Koh'),
        (N'B', N'Merapoh')
)dta(SiteName, VillageName)

INSERT INTO [Subject].Village ([Name], GPSLatitude, GPSLongitude, EthnicGroup, HasRunningWater, HasElectricity, HasSchool, DistanceToMarket)
SELECT VillageName, Lat, Long, EthnicGrp, Water, Electic, School, MarketDist
FROM(
    VALUES
        (N'Kuala Lumpur',3.1478,101.6953,2,0,0,1,23),
        (N'Klang',3.0333,101.45,8,0,1,0,21),
        (N'Ipoh',4.6,101.07,4,1,0,1,11),
        (N'Butterworth',5.3942,100.3664,3,1,0,1,20),
        (N'George Town',5.4145,100.3292,2,0,1,0,7),
        (N'Petaling Jaya',3.1073,101.6067,9,0,0,0,15),
        (N'Kuantan',3.8167,103.3333,9,1,0,0,7),
        (N'Shah Alam',3.0833,101.5333,2,0,0,0,25),
        (N'Johor Bahru',1.4556,103.7611,9,1,1,0,24),
        (N'Kota Bharu',6.1333,102.25,1,1,1,1,2),
        (N'Melaka',2.1889,102.2511,4,1,1,0,9),
        (N'Kota Kinabalu',5.975,116.0725,6,0,1,0,22),
        (N'Seremban',2.7297,101.9381,2,1,0,1,9),
        (N'Sandakan',5.8388,118.1173,4,0,1,1,5),
        (N'Sungai Petani',5.65,100.48,1,1,0,1,2),
        (N'Kuching',1.5397,110.3542,4,1,1,0,16),
        (N'Kuala Terengganu',5.3303,103.1408,1,0,0,0,16),
        (N'Alor Setar',6.1167,100.3667,9,1,0,0,2),
        (N'Putrajaya',2.914,101.7019,9,1,0,0,12),
        (N'Kangar',6.4414,100.1986,4,1,0,0,14),
        (N'Labuan',5.2803,115.2475,7,1,1,1,19),
        (N'Pasir Mas',6.0493,102.1399,7,0,1,1,25),
        (N'Tumpat',6.2,102.1667,9,0,1,0,14),
        (N'Ketereh',5.957,102.2482,6,0,1,0,18),
        (N'Kampung Lemal',6.0302,102.1413,3,1,1,0,1),
        (N'Pulai Chondong',5.8713,102.2318,1,1,0,1,25)
)dta(VillageName, Lat, Long, EthnicGrp, Water, Electic, School, MarketDist)

INSERT INTO [Subject].[Residence] (SubjectID, [Date], VillageID)
SELECT SubjectID,[Date],VillageID
FROM(
    VALUES
        (47,N'2004-01-25',13),
        (84,N'2015-01-29',7),
        (50,N'2016-01-24',21),
        (166,N'2016-01-06',23),
        (190,N'2005-01-13',16),
        (3,N'2017-01-04',6),
        (101,N'1998-01-10',13),
        (90,N'2005-01-18',23),
        (70,N'2007-01-06',9),
        (167,N'2014-01-20',6),
        (24,N'2005-01-15',8),
        (180,N'2018-01-14',22),
        (63,N'1996-01-22',7),
        (38,N'2004-01-17',21),
        (130,N'1991-01-14',5),
        (33,N'2012-01-20',28),
        (175,N'2010-01-18',12),
        (191,N'2019-01-08',21),
        (176,N'2003-01-26',23),
        (27,N'2016-01-26',9),
        (19,N'2010-01-28',15),
        (10,N'2014-01-02',4),
        (158,N'2016-01-10',18),
        (200,N'2000-01-04',7),
        (143,N'1991-01-27',28),
        (166,N'1994-01-06',27),
        (3,N'2001-01-15',22),
        (41,N'2015-01-20',13),
        (128,N'2015-01-12',12),
        (174,N'2010-01-24',13),
        (67,N'2000-01-05',10),
        (71,N'2016-01-05',4),
        (183,N'2017-01-31',19),
        (87,N'1990-01-04',8),
        (3,N'2006-01-15',8),
        (184,N'1997-01-01',6),
        (178,N'1992-01-29',12),
        (17,N'2008-01-19',8),
        (127,N'1999-01-13',15),
        (116,N'2001-01-23',21),
        (195,N'1995-01-31',23),
        (194,N'2003-01-13',2),
        (72,N'2011-01-08',1),
        (133,N'2020-01-24',4),
        (156,N'2010-01-30',11),
        (151,N'2007-01-22',16),
        (38,N'1992-01-14',17),
        (44,N'2016-01-15',22),
        (152,N'1998-01-27',9),
        (162,N'2018-01-14',2),
        (5,N'1991-01-26',24),
        (16,N'2002-01-20',25),
        (184,N'2002-01-23',26),
        (21,N'2002-01-07',1),
        (84,N'2001-01-20',3),
        (35,N'2009-01-17',22),
        (35,N'2001-01-22',2),
        (158,N'2002-01-08',2),
        (68,N'2014-01-04',6),
        (41,N'2011-01-14',2),
        (61,N'1997-01-20',11),
        (131,N'1994-01-02',16),
        (1,N'1997-01-13',12),
        (66,N'1999-01-01',10),
        (188,N'2010-01-01',20),
        (125,N'2012-01-08',19),
        (195,N'1995-01-17',20),
        (168,N'2002-01-25',19),
        (149,N'2009-01-16',9),
        (83,N'2017-01-26',26),
        (200,N'2002-01-15',2),
        (57,N'1993-01-22',14),
        (6,N'2001-01-26',27),
        (71,N'1997-01-29',17),
        (172,N'2003-01-24',5),
        (197,N'2011-01-10',6),
        (98,N'2004-01-08',11),
        (170,N'1994-01-09',25),
        (83,N'2012-01-05',2),
        (118,N'2009-01-05',22),
        (37,N'2017-01-22',9),
        (80,N'2021-01-04',1),
        (155,N'2014-01-28',23),
        (171,N'2002-01-15',19),
        (36,N'2013-01-12',4),
        (44,N'2012-01-26',1),
        (27,N'2016-01-07',19),
        (192,N'2011-01-05',4),
        (184,N'2014-01-03',12),
        (186,N'2017-01-05',9),
        (111,N'2010-01-19',15),
        (156,N'2010-01-29',15),
        (200,N'2012-01-18',3),
        (176,N'2004-01-19',1),
        (135,N'2021-01-18',26),
        (178,N'2014-01-07',27),
        (116,N'2005-01-12',26),
        (160,N'1997-01-18',25),
        (104,N'2015-01-15',6),
        (152,N'2009-01-10',26),
        (68,N'2015-01-17',21),
        (42,N'1999-01-29',16),
        (7,N'2007-01-01',4),
        (50,N'1995-01-26',23),
        (126,N'2009-01-15',1),
        (24,N'2007-01-06',16),
        (164,N'1992-01-25',23),
        (43,N'2009-01-23',27),
        (104,N'2008-01-09',8),
        (158,N'1995-01-11',2),
        (15,N'2000-01-07',2),
        (36,N'2000-01-22',13),
        (71,N'2021-01-24',15),
        (55,N'2004-01-18',23),
        (39,N'2015-01-24',6),
        (119,N'2000-01-23',13),
        (168,N'2013-01-17',28),
        (126,N'2001-01-19',22),
        (60,N'2007-01-25',16),
        (114,N'1995-01-24',21),
        (134,N'1990-01-17',20),
        (3,N'2017-01-14',5),
        (159,N'1998-01-21',8),
        (175,N'2001-01-19',2),
        (84,N'1999-01-23',14),
        (104,N'2013-01-25',4),
        (83,N'2013-01-20',2),
        (109,N'1995-01-26',15),
        (66,N'2011-01-04',11),
        (14,N'2021-01-09',28),
        (14,N'1992-01-16',22),
        (24,N'2012-01-21',12),
        (12,N'1997-01-17',22),
        (56,N'2009-01-09',7),
        (172,N'2000-01-28',1),
        (45,N'2013-01-10',2),
        (152,N'2016-01-21',5),
        (88,N'2018-01-12',9),
        (181,N'2007-01-16',19),
        (132,N'1992-01-21',13),
        (146,N'2000-01-15',24),
        (78,N'2015-01-13',16),
        (180,N'2013-01-18',16),
        (76,N'1997-01-19',8),
        (141,N'2011-01-23',26),
        (138,N'2005-01-15',14),
        (2,N'1992-01-13',9),
        (182,N'2019-01-13',6),
        (98,N'2016-01-31',3),
        (53,N'1997-01-07',8),
        (8,N'1990-01-16',24),
        (196,N'2017-01-10',28),
        (171,N'1990-01-16',7),
        (152,N'2000-01-07',20),
        (33,N'1991-01-20',5),
        (74,N'1990-01-29',5),
        (51,N'2019-01-31',4),
        (89,N'2021-01-18',10),
        (175,N'2004-01-21',15),
        (170,N'1991-01-06',20),
        (198,N'2007-01-16',2),
        (100,N'2007-01-24',4),
        (128,N'2011-01-23',11),
        (113,N'2018-01-23',12),
        (115,N'2019-01-05',25),
        (199,N'2006-01-23',12),
        (113,N'1993-01-19',22),
        (65,N'2018-01-30',20),
        (191,N'2010-01-18',13),
        (197,N'2001-01-06',13),
        (98,N'2006-01-06',5),
        (199,N'2007-01-16',3),
        (23,N'2000-01-17',17),
        (34,N'2006-01-20',28),
        (114,N'2005-01-23',10),
        (127,N'2020-01-16',3),
        (98,N'2013-01-15',25),
        (187,N'2007-01-27',15),
        (140,N'2009-01-02',13),
        (60,N'1990-01-17',25),
        (107,N'2009-01-24',7),
        (87,N'2012-01-10',2),
        (18,N'2004-01-16',4),
        (117,N'2009-01-17',8),
        (16,N'1993-01-03',5),
        (136,N'2010-01-30',24),
        (82,N'1990-01-24',3),
        (147,N'2000-01-15',24),
        (180,N'2001-01-28',27),
        (58,N'2007-01-25',17),
        (196,N'2021-01-22',21),
        (40,N'2019-01-05',13),
        (188,N'2006-01-07',2),
        (115,N'1993-01-18',7),
        (30,N'2009-01-13',2),
        (132,N'2015-01-31',26),
        (148,N'1991-01-12',24),
        (9,N'2019-01-06',11),
        (176,N'2019-01-23',20),
        (83,N'2013-01-25',13),
        (159,N'2000-01-11',11),
        (49,N'2000-01-04',27),
        (41,N'2020-01-19',7),
        (121,N'2011-01-29',29),
        (172,N'1995-01-21',5),
        (145,N'1996-01-14',29),
        (26,N'2018-01-01',22),
        (88,N'2006-01-01',13),
        (157,N'2021-01-07',16),
        (135,N'2000-01-07',26),
        (149,N'1993-01-25',18),
        (9,N'2013-01-30',1),
        (41,N'2010-01-20',7),
        (65,N'2016-01-15',22),
        (125,N'1992-01-18',23),
        (112,N'2016-01-04',13),
        (132,N'1999-01-09',30),
        (10,N'1996-01-09',5),
        (122,N'2009-01-20',24),
        (183,N'2022-01-31',4),
        (83,N'2001-01-04',23),
        (48,N'2018-01-25',27),
        (79,N'2018-01-06',2),
        (95,N'1991-01-04',5),
        (166,N'2013-01-16',19),
        (42,N'2013-01-18',2),
        (141,N'2001-01-19',29),
        (133,N'2012-01-20',28)
)dta(SubjectID, [Date], VillageID)

DELETE FROM [Subject].Residence
FROM [Subject].[Residence] R
    INNER JOIN [Subject].[Subject] S ON S.SubjectID = R.SubjectID
WHERE R.[Date] < DOB